W$LICENSE="Weaveworld Public License v1.0, Copyright(c)2018-2019, Csaba Veg, All rights reserved.\nPermission to USE and/or REDISTRIBUTE this software in UNMODIFIED forms, in source and/or binary distributions, for any purpose with or without fee is hereby granted, provided that the above copyright notice and this permission notice appear in all copies.\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.";
String.prototype.startsWith||(String.prototype.startsWith=function(a,c){var b=c||0,d=a.length;if(b+d>this.length)return!1;for(var e=0;e<d;++e,++b)if(a.charAt(e)!=this.charAt(b))return!1;return!0});String.prototype.endsWith||(String.prototype.endsWith=function(a,c){var b=c||this.length,d=a.length;if(b<d)return!1;for(;0<=--d;)if(--b,a.charAt(d)!=this.charAt(b))return!1;return!0});Array.prototype.forEach||(Array.prototype.forEach=function(a,c){for(var b=0,d=this.length;b<d;++b)a.call(c,this[b],b,this)});
function w$derive(a,c){a.prototype&&a.prototype.isPrototypeOf(c)||Object.setPrototypeOf(c,a);return c}
function w$assign(a,c,b,d){var e,g=!1;if(null==c||"object"!=typeof c)return c;"boolean"==typeof b&&(g=b,b=d);if(b)for("string"==typeof b&&(b=b.split(",")),d=0;d<b.length;++d){var k=b[d],h=k;-1!=(e=k.indexOf(":"))&&(h=k.substring(0,e),k=k.substring(e+1));e=c[k];if(g?null!=e:"undefined"!=typeof e)a[h]=e}else for(k in c)c.hasOwnProperty(k)&&(e=c[k],(g?null!=e:"undefined"!=typeof e)?a[k]=e:delete a[k]);return a}
function w$is(a,c){a=a&&("undefined"==typeof a.length||0<a.length);return 1===c?a?1:0:"string"==typeof c?a?c:null:a?!0:!1}function w$toggle(a,c){"0"===a?a=0:"1"===a?a=1:"true"===a?a=!0:"false"===a?a=!1:"string"==typeof a&&a===c&&(a=!0);return w$is(!a,c)}function w$isElements(a){return a&&(a instanceof HTMLCollection||Array.isArray(a))}function w$oneOrMore(a,c){return null===c?0==a:a<c}function w$isArray(a){return"object"==typeof a&&a&&(Array.isArray(a)||a.$w$isArray)}
function w$query(a,c,b){var d=!1,e=0,g=c||document,k=!1;if(a)if("object"==typeof a){k=w$isElements(a);var h=a}else{if(-1!=a.indexOf(";")){var l=a.split(";");h=[];k=!0}if(b||w$isElements(g))h=[],k=!0;for(var m=Array.isArray(l)?l.length:null,r=0;w$oneOrMore(r,m);++r){null!==m&&(a=l[r]);d=!1;e=0;if(a.startsWith(" "))d=!1,a=a.substring(1);else if(a.startsWith("##"))d=!0,e=2;else if(a.startsWith("#")){d=!0;for(var f=e=1;f<a.length;++f){var q=a.charAt(f);if(!("a"<=q&&"z">=q||"A"<=q&&"Z">=q||f>e&&("0"<=
q&&"9">=q||"_"==q||"-"==q))){d=!1;break}}}else a.startsWith("=")&&(a="*[name='"+a.substring(1)+"']");q=g instanceof HTMLCollection||Array.isArray(g)?v.length:"1";for(var z=-1;++z<q;){var v="number"==typeof q?g[z]:g;if(0==a.indexOf(">"))(f=function p(a,f,c){var d=a.indexOf(">"),e=(-1!=d?a.substring(0,d):a).split("."),q=0;a:for(;q<f.children.length;++q){var m=f.children[q];if(!e[0]||"*"==e[0]||e[0].toUpperCase()==m.nodeName){for(var h=1;h<e.length;++h)if(!m.classList.contains(e[h]))continue a;if(-1!=
d)return p(a.substring(d+1),m,c);Array.isArray(c)&&c.push(m);if(!b)return m}}return null}(a.substring(1),c,h))&&!k&&(h=f);else if(d)f=document.getElementById(a.substring(e)),k?h.push(f):h=f;else if(k){var C=v.querySelectorAll(a);for(f=0;f<C.length;++f)h.push(C[f])}else h=v.querySelector(a)}if(!k)break}}else h=g;b?w$isElements(h)||(h=h?[h]:[]):w$isElements(h)&&(h=h.length?h[0]:null);if("function"==typeof b)for(f=0;f<h.length;++f)b(h[f]);return h}
function w$queryAll(a,c,b){return w$query(a,c,b||!0)}
function w$show(a,c){c==WEAVEWORLD.W$TOGGLE&&(c=!w$show(a));if("undefined"==typeof c)return"none"!=window.getComputedStyle(a).display;if(c)return"none"==window.getComputedStyle(a).display&&(a.style.display=a.$w&&a.$w.$styleDisplay?a.$w.$styleDisplay:/^(address|blockquote|body|center|dir|div|dl|fieldset|form|h[1-6]|hr|isindex|menu|noframes|noscript|ol|p|pre|table|ul|dd|dt|frameset|li|tbody|td|tfoot|th|thead|tr|html)$/i.test(a.nodeName)?"block":"inline"),!0;var b;(a.$w||(a.$w={})).$styleDisplay||"none"==
(b=window.getComputedStyle(a).display)||(a.$w.$styleDisplay=b);a.style.display="none";return!1}function w$attribute(a,c){var b=a.getAttribute(c);return null!=b?b:a.hasAttribute(c)?"":null}function w$hasParent(a,c){c||(c=document.body);for(;a;a=a.parentElement)if(a===c)return!0;return!1}
function w$element(a,c,b,d){if("string"==typeof a){if(!a||"#text"==a)return document.createTextNode(c);a=document.createElement(a)}var e=a,g=w$isElements(a)?a.length:null;if("string"==typeof c){d=!1!==d;for(var k=0;w$oneOrMore(k,g);++k){var h=c,l;null!==g&&(a=e[i]);d&&"w:text"==h?a.textContent=b||"":d&&"w:html"==h?a.innerHTML=b||"":d&&h.startsWith(l="w:set:")?a[h.substring(l.length)]=b:d&&h.startsWith(l="w:data:")?(h="data-"+h.substring(l.length),null!=b?a.setAttribute(h,b):a.removeAttribute(h)):
d&&h.startsWith(l="w:style:")?(h=h.substring(l.length),null!=b?a.style[h]=b:a.removeStyle(h)):d&&"w:show"==h?w$show(a,"undefined"!=typeof b?b:null):(h.startsWith("@")&&(h=h.substring(1)),d&&h.startsWith(l="w:attr:")&&(h=h.substring(l.length)),null!=b?a.setAttribute(h,b):a.removeAttribute(h))}}else if("object"==typeof c)for(k=0;w$oneOrMore(k,g);++k)for(h in null!==g&&(a=e[k]),c)w$element(a,h,c[h],b);return a}
function w$defineElement(a,c,b){if(c){var d=c,e,g={};w$isArray(c)||(d=c.replace(/;;/g,"\n").split("\n"));for(c=0;c<d.length;++c)if((e=d[c].trim())&&"#"!=e.charAt(0)){var k=e,h=e,l;-1!=(l=e.indexOf("="))&&(k=e.substring(0,l),h=e.substring(l+1));g[k]=h;"@"==k.charAt(0)?"object"==typeof a&&a&&w$element(a,k.substring(1),h):-1==k.indexOf(".@")&&b&&b(a,k,h)}return g}}
function w$defineSelect(a,c,b){var d=w$defineElement(null,c);a.innerHTML="";w$defineElement(a,c,function(c,g,k){c=g+".@";k=a.appendChild(w$element("option",{"w:set:value":g,"w:text":k}));b==g&&(k.selected=!0);for(var e in d)e.startsWith(c)&&w$element(k,e.substr(c.length),d[e])});return a}
function w$radioClick(a){var c=a.target;if("INPUT"==c.nodeName&&"radio"==c.type)return a.stopPropagation(),a.cancelBubble=!0;w$queryAll("input[type='radio']",c.parentElement,function(a){a.checked=!0});return w$no(a)}
function w$defineRadio(a,c,b,d,e){var g=w$defineElement(null,b);a.innerHTML="";w$defineElement(a,b,function(b,h,l){b=h+".@";var m=a.appendChild(w$element("span",{"class":"wradio",style:"white-space:nowrap;",onclick:"return w$radioClick(event,this)"})),r=m.appendChild(w$element("input",{type:"radio",name:c,value:h}));d==h&&(r.checked=!0);m.appendChild(w$element("span",{"w:text":l}));for(var f in g)f.startsWith(b)&&w$element(m,f.substr(b.length),g[f]);e&&e.call(this,m)});return a}
function w$removeElement(a){return a&&a.parentElement?(a.parentElement.removeChild(a),a.parentElement=null,!0):!1}function w$hasWarning(a){if(a)for(var c=Object.getOwnPropertyNames(a),b=0;b<c.length;++b){var d=c[b];if((d.startsWith("_w_")||"_w"==d||d.endsWith("$warning"))&&a[d])return!0}return!1}
function w$warning(a,c){a instanceof HTMLElement&&(a=w$data(a));if(a){if(c){var b=Object.getOwnPropertyNames(c);for(var d=!1,e=0;e<b.length;++e){k=b[e];var g;if(k.startsWith(g="_w_")||k==(g="_w"))d=(d=c[k])?w$say(d,d):void 0,a[k.substring(g.length)+"$warning"]=d,d=!0;else if(k.startsWith(g="_m_")||k==(g="_m"))d=(d=c[k])?w$say(d,d):void 0,a[k.substring(g.length)+"$message"]=d,d=!0}return d}Object.getOwnPropertyNames(a);for(var k in a)if(k.endsWith("$warning")||k.endsWith("$message"))a.$w$proxy&&null==
a[k]||(a[k]=void 0)}}function w$check(a,c){if(a){a instanceof Event&&(a=a.target);var b,d,e,g;a.checkValidity&&a.checkValidity();if((b=a.getAttribute("name"))&&(d=w$find$(a))&&(e=w$data(d))){var k;"undefined"==typeof c&&(c=w$get(a));if("undefined"!=typeof c){var h=b+"$warning";"function"==typeof(k=e[b+"$check"])?g=k.call(e,a,d,c):"function"==typeof(k=e[b+"$valid"])&&(g=k.call(e,c));e.$w$proxy&&e[h]==g||(e[h]=g||void 0)}}return g}}
function w$checkArg(a,c,b,d){var e=a,g;if(!b)return null;a instanceof Event&&(a=a.target);a instanceof HTMLElement&&(e=w$data(a));if(!d&&a instanceof HTMLElement&&"function"==typeof(g=e[(c||"")+"$check"]))a=g.call(e,a,b);else if(d||"function"!=typeof(g=e[(c||"")+"$valid"])){d=Object.getOwnPropertyNames(b);a={};for(var k=0;k<d.length;++k){var h=d[k];if(c&&"function"==typeof(g=e[c+"$"+h+"$valid"])){var l=g.call(e,b[h]);a["_w_"+h]=l||void 0}else"function"==typeof(g=e[h+"$valid"])&&(l=g.call(e,b[h]),
a["_w_"+h]=l||void 0)}}else a=g.call(e,b);return"string"==typeof a?a?{_w:a}:null:"object"!=typeof a||0===Object.keys(a).length&&a.constructor===Object?null:a}function w$hasAncestor(a,c){for(;a&&a!=document;a=a.parentElement)if(a==c)return!0;return!1}
function w$find(a,c,b){"string"==typeof a&&(a=w$query(a));var d;if(!c)throw Error("Missing description parameter!");if("string"==typeof c)if(-1==(d=c.lastIndexOf("."))){var e=c;c=null}else e=c.substring(0,d),c=c.substring(d+1);a&&b&&(a=a.parentElement);for(;a&&a!=document;a=a.parentElement)if(b=a.classList,(!e||e==a.nodeName)&&b&&b.length)if("string"==typeof c){if(b.contains(c))return a}else for(d=0;d<c.length;++d)if(b.contains(c[d]))return a;return null}
function w$selectAll(a,c){if(a instanceof HTMLElement){var b=window.getSelection();b.removeAllRanges();if("INPUT"==a.nodeName)a.focus(),a.setSelectionRange(0,a.value.length);else{var d=document.createRange();d.selectNodeContents(a);b.addRange(d)}}else if(a instanceof Event){d=a.target;var e=document.activeElement==d||(b=window.getSelection())&&b.baseNode==d;e||"DIV"!=d.nodeName||"true"==d.getAttribute("contenteditable")||(e=!0);if(!e&&(w$selectAll(d),!c))return w$no(a)}}
function w$getParameters(a,c){null==c&&(c=window.location.search);a||(a={});c.startsWith("?")&&(c=c.substring(1));if(c)for(var b=c.split("&"),d=0;d<b.length;++d){var e=b[d].split("="),g=decodeURIComponent(e[0]),k;e=null==e[1]?null:decodeURIComponent(e[1]);g in a?w$isArray(k=a[g])?k.push(e):a[g]=[k,e]:a[g]=e}return a}
function w$setParameters(a,c){null==c&&(c=window.location.href);var b,d="";-1!=(b=c.indexOf("?"))&&(d=c.substring(b),c=c.substring(0,b));b=w$assign(w$getParameters({},d),a);d="";var e="?",g;for(g in b){var k=b[g];"undefined"!=typeof k&&(d+=e+g,null!=k&&(d+="="+encodeURIComponent(b[g])),e="&")}return c+d}function w$setCookie(a,c,b){var d="; expires=0";b&&(d="; expires="+(new Date(Date.now()+864E5*b)).toGMTString());document.cookie=a+"="+c+d+"; path=/"}
function w$getCookie(a,c){for(var b=a+"=",d=document.cookie.split(";"),e=0;e<d.length;++e){for(var g=d[e];g.startsWith(" ");)g=g.substring(1);if(g.startsWith(b))return g.substring(b.length)}return c}
function w$get(a,c){"string"==typeof a&&(a=w$query(id,c));if(a){if("FORM"==a.nodeName){for(var b={},d=0;d<a.elements.length;++d){var e=a.elements[d],g;("INPUT"==e.nodeName&&"submit"!=e.type&&"reset"!=e.type&&"button"!=e.type||"SELECT"==e.nodeName||"TEXTAREA"==e.nodeName)&&"undefined"!=typeof(g=w$get(e))&&(b[e.name]=g)}return b}if("INPUT"==a.nodeName){if("checkbox"==a.type||"radio"==a.type){if(a.checked)return a.value;return}return a.value}if("SELECT"==a.nodeName){b=void 0;e="";for(d=0;d<a.length;++d)a.options[d].selected&&
(b=(b||"")+e+a.options[d].value,e=",");return b}return"TEXTAREA"==a.nodeName?a.value:a.innerHTML}return null}
function ASync(){this.queue=[];this.locked=!1;this.exec=function(a,c,b){if("string"==typeof c){var d=this;this.exec(function(){d.locked=!0;var e=b||new Image;e.onload=function(){try{a&&a(e)}finally{d.locked=!1}};e.onerror=function(){d.locked=!1};e.src=c})}else this.queue.push(a),this.queueID||(this.queueID=requestAnimationFrame(this.sync.bind(this)))};this.sync=function(a){a=this.queue;if(a.length){if(!this.locked){a=a.shift();try{a()}catch(c){console.log("async exception:",c)}}this.queueID=requestAnimationFrame(this.sync.bind(this))}else this.queueID=
null}}function w$glass(a){if(a)(a=WEAVEWORLD.w$glass)?w$show(a,!0):document.body&&(WEAVEWORLD.w$glass=w$element("div",{"class":"wglass"}),document.body.insertBefore(WEAVEWORLD.w$glass,document.body.firstElementChild)),setTimeout(function(){var a;(a=WEAVEWORLD.w$glass)&&a.setAttribute("disabled","")},2E3);else if(a=WEAVEWORLD.w$glass)w$removeElement(WEAVEWORLD.w$glass),WEAVEWORLD.w$glass=null;return WEAVEWORLD.w$glass}
function w$ajax(a){if("undefined"!=typeof XMLHttpRequest)var c=new XMLHttpRequest;else for(var b="MSXML2.XmlHttp.6.0 MSXML2.XmlHttp.5.0 MSXML2.XmlHttp.4.0 MSXML2.XmlHttp.3.0 MSXML2.XmlHttp.2.0 Microsoft.XmlHttp".split(" "),d=0;d<b.length;d++)try{c=new ActiveXObject(b[d]);break}catch(l){}a.async||w$glass(!0);c.onreadystatechange=function(){a.xhr=c;if(4==c.readyState){var b=c.status;200==b||304==b||400<=b&&500>b||!a.error?(b=c.responseText,w$glass(),(c.getResponseHeader("Content-Type")||"").startsWith("application/json")&&
(b=JSON.parse(b)),a.success&&a.success(b,a)):a.error&&a.error(c);a.loop&&!WEAVEWORLD["@end"]&&requestAnimationFrame(a.loop)}};a.withCredentials&&(c.withCredentials=!0);b=a.data||{};d=a.method||"GET";var e="";if("GET"==d||"POST"==d){var g="GET"==d?"?":"";for(var k in b){var h;"undefined"!=typeof(h=b[k])&&(e+=g+encodeURIComponent(k),null!=h&&(e+="="+encodeURIComponent(b[k])),g="&")}b=e;g="application/x-www-form-urlencoded; charset=UTF-8"}else"object"==typeof b&&(b=JSON.stringify(b),g="application/json; charset=UTF-8");
d.endsWith(".json")&&(d=d.substring(0,d.length-5));"GET"==d?(c.open("GET",(a.url||"")+e,"undefined"!=typeof a.async?a.async:!0),a.pragma&&c.setRequestHeader("Pragma",a.pragma),c.send()):(c.open(d,a.url||"","undefined"!=typeof a.async?a.async:!0),a.pragma&&c.setRequestHeader("Pragma",a.pragma),g&&c.setRequestHeader("Content-type",g),c.send(b))}
function W$CALL(){var a=0,c,b;"string"==typeof arguments[a]&&(c=arguments[a++]);if(null==arguments[a]||"object"==typeof arguments[a]&&!(arguments[a]instanceof HTMLElement)){var d=arguments[a++];"object"!=typeof arguments[a]||arguments[a]instanceof HTMLElement||(b=arguments[a++])}b||(b={});arguments[a]instanceof HTMLElement&&(b.w$element=arguments[a++],b.success||(b.success=WEAVEWORLD.w$receive),"string"==typeof arguments[a]&&(b.w$cmd=arguments[a++]),"object"==typeof arguments[a]&&arguments[a]&&(b.weave$data=
arguments[a++]));"function"==typeof arguments[a]&&(b[b.success?"callback":"success"]=arguments[a++]);b.success||(b.success=WEAVEWORLD.w$receive);"undefined"==typeof b.error&&(b.error=WEAVEWORLD.w$ajax$error);"undefined"==typeof b.pragma&&(b.pragma="W$CALL");b.method||(b.method="POST.json");b.url||(b.url=location.pathname);"string"==typeof c?(b.data={},-1!=(a=c.indexOf(":"))?(b.method=c.substring(0,a),b.url=c.substring(a+1)):b.data[c]="","object"==typeof d&&d&&w$assign(b.data,d)):"object"==typeof d&&
d&&(b.data=d);!b.w$element||b.w$cmd&&b.w$cmd.startsWith("~")||w$warning(b.w$element);w$ajax(b)}function w$sync(){w$ajax({method:"GET",url:location.pathname,pragma:"W$CALL",data:{"!@":WEAVEWORLD["@time"]},async:!0,success:WEAVEWORLD.w$receive,loop:w$sync})}function w$wmenuOff(a){for(var c=WEAVEWORLD.menuStack;c.length&&c[c.length-1]!=a;)w$removeElement(c.pop())}
function w$wmenuShow(a,c,b,d,e,g,k,h){var l=void 0;"string"==typeof c&&(c=document.getElementById(c),c=c.cloneNode(!0),c.removeAttribute("id"));c.$w||(c.$w={});c.$w.parent=a;k&&(l=k(a,c,b,d,e,g));c.classList.remove("w");WEAVEWORLD.menuStack.push(c);for(k=0;k<c.children.length;++k){var m=c.children[k];m.classList.contains("wmenuitem")&&(m.classList.remove("wmenuitem-selected"),m.onmouseover=function(b){var f=b.target;w$no(b);for(b=0;b<c.children.length;++b){var d=c.children[b];d.classList.contains("wmenuitem")&&
d!=f&&d.classList.remove("wmenuitem-selected")}f.classList.add("wmenuitem-selected");b=f.getBoundingClientRect();for(d=0;d<f.children.length;++d){var e=f.children[d];if(e.classList.contains("wmenu")){w$wmenuShow(a,e.cloneNode(!0),b.right-2,b.left,b.top,b.bottom,null,h);break}}},m.onclick=function(b){w$no(b);var f=b.currentTarget;if(f.classList.contains("disable"))return!1;for(var c=f.getBoundingClientRect(),d=0;d<f.children.length;d++){var e=f.children[d];if(e.classList.contains("wmenu"))return w$wmenuShow(a,
e.cloneNode(!0),c.right-5,c.left,c.top,c.bottom,null,h),!1}f.getAttribute("w:on:menu");c={};var m;null!=(m=w$attribute(f,"w:checked"))&&(c[w$findName(f)||"value"]=m);w$on(b,"menu",null,c);w$wmenuOff()})}c.onmouseout=function(a){w$no(a);a=a.relatedTarget||document.activeElement;if(c.classList.contains("wmenuM"))return!1;for(;null!=a&&!a.classList.contains("wmenu");)a=a.parentElement;w$wmenuOff(a)};"undefined"==typeof l&&(c.style.position="absolute",c.style.display="inline-block",c.style.left=(b+=window.pageXOffset)+
"px",c.style.top=(e+=window.pageYOffset)+"px",document.body.appendChild(c),b=document.body.getBoundingClientRect(),e=c.getBoundingClientRect(),e.right>b.right&&(c.style.left=Math.max(0,d-e.width+window.pageXOffset)+"px"),e.bottom>b.bottom&&(c.style.top=Math.max(0,g-e.height+window.pageYOffset)+"px"));return c}
function w$menu(a,c,b,d){if(a instanceof Event){var e=a;a=e.target;w$no(e);var g={left:e.clientX,right:e.clientX,top:e.clientY,bottom:e.clientY};c||(c=a.getAttribute("w:on:"+e.type+":menu")||a.getAttribute("w:menu"))}else g=a.getBoundingClientRect(),c||(c=a.getAttribute("w:menu"));"string"==typeof c&&(c.startsWith("#")?(c=w$query(c),c=c.cloneNode(!0),c.removeAttribute("id"),c.$w||(c.$w={}),c.$w.parent=a):(e=w$data(a),c=w$use(c,e||{},null,a)));w$wmenuShow(a,c,g.left,g.right,g.top,g.bottom,b,d)}
function w$no(a){a.preventDefault();a.stopPropagation();a.cancelBubble=!0;return!1}function w$default(a){a.stopPropagation();a.cancelBubble=!0;return!1}
function w$action(a,c,b){var d;c&&c.target==a&&b&&a.name in b&&w$check(a,b[a.name]);for(;a&&(!a.$w||!(d=a.$w.$actions));a=a.parentElement);if(!a)return null;if(w$isArray(d)){var e,g;null!=b&&(e=a.$w.$cx)||(e=a.$w.$cx={});(g=w$data(a))||(g={});Object.setPrototypeOf(e,g);null==b?b=g:Object.setPrototypeOf(b,e);var k=0;a:for(;k<d.length;++k){var h=d[k];if(!w$hasParent(h.el)){d.splice(k--,1);continue a}h=h.$do.call(g,a,c,b,h.el);"object"==typeof h&&(b=h);if(b!=g)for(h=Object.getOwnPropertyNames(b),k=0;k<
h.length;++k){var l=h[k];e.hasOwnProperty(l)?e[l]=b[l]:Object.defineProperty(e,l,{value:b[l],writable:!0,enumerable:!0,configurable:!0})}}}}
function w$arg(){for(var a=0,c={},b=!0;a<arguments.length;++a){var d=arguments[a];if("string"==typeof d)c[d]="";else if("object"!=typeof d||!d||d instanceof HTMLElement)if("boolean"==typeof d)b=d;else break;else w$assign(c,d)}d=arguments[a];for(var e=w$data(d),g=arguments[a+1].split(","),k=0;k<g.length;++k){var h=g[k].trim(),l,m;b&&(m=h.startsWith(WEAVEWORLD.W$TOGGLE))&&(h=h.substring(WEAVEWORLD.W$TOGGLE.length));if(m){var r=!0;-1!=(l=h.indexOf(":"))&&(r=WEAVEWORLD.weave$evalMacro(d,e,h.substring(l+
1),!1),h=h.substring(0,l));var f=e[h];f=w$toggle(f,r)}else-1!=(l=h.indexOf(":"))?(f=WEAVEWORLD.weave$evalMacro(d,e,h.substring(l+1),!1),h=h.substring(0,l)):f=e[h];"undefined"!=typeof f&&(c[h]=f)}for(a+=2;a<arguments.length;++a)d=arguments[a],"object"==typeof d&&d&&w$assign(c,d);return c}
function w$on(a,c,b,d,e,g){function k(a){if(!a)return-1;var f=a.indexOf("{");a=a.indexOf("(");return-1!=f&&-1!=a?Math.min(f,a):-1!=f?f:-1!=a?a:-1}function h(a,f,b){var c=k(f),d;if((f=-1!=c?f.substring(c):"")&&"{"==f.charAt(c)){if(c=w$data(a),-1!=f.indexOf("{{")&&(f="{"+WEAVEWORLD.weave$evalMacro(a,c,f.substring(1),!0)),"{}"!=f)try{var e=JSON.parse(f)}catch(x){console.log(x)}}else"()"!=f&&(f.endsWith(")")&&(f=f.substring(0,f.length-1)),e=w$arg(a,f.substring(1)));c=b;e&&(c=c?w$assign(c,e):e);c||(c=
{});if(b&&(null!=(d=w$attribute(a,"w:name"))||null!=(d=w$attribute(a,"name")))&&d){var q;a.hasAttribute("w:checked")?c[d]=a.getAttribute("w:checked"):"undefined"!=typeof(q=a.value)&&(c[d]=q)}return c}var l=b=b||a.target,m,r=null;c="string"==typeof e?e:"on"+c;try{a:for(;b;b=!c.startsWith("on")&&b.$w&&b.$w.parent?b.$w.parent:b.parentElement){var f;if(b.getAttribute){if(f=b.getAttribute("w:on:"+c+":menu")){w$no(a);var q=h(b,f),z;-1!=(z=k(f))&&(f=f.substring(0,z));var v=w$data(b);r=b.getBoundingClientRect();
v&&(0===Object.keys(q).length?q=v:Object.setPrototypeOf(q,v));var C=w$use(f,q,null,b);w$wmenuShow(b,C,r.left,r.right,r.top,r.bottom);return!0}if(b.hasAttribute(f="w:on:"+c+":data")){var w=b;q=h(b,f=b.getAttribute(f));w=0<(z=k(f))?w$find(w,f.substring(0,z)):w$find$(w);for(var A in q){var D=q[A];A.startsWith(WEAVEWORLD.W$TOGGLE)&&(A=A.substring(WEAVEWORLD.W$TOGGLE.length),w.dataset&&(D=w$toggle(w$attribute(w,"data-"+A),D)));null!=D?w.setAttribute("data-"+A,D):w.removeAttribute("data-"+A)}}if(null!=
(f=w$attribute(b,"w:on:"+c+":set")))for(A in w=b,q=h(b,f,d||{}),0<(z=f.indexOf("("))&&(w=w$find(w,f.substring(0,z))),w=w$find$(w),q)D=q[A],A.startsWith(WEAVEWORLD.W$TOGGLE)&&(A=A.substring(WEAVEWORLD.W$TOGGLE.length),w.$w.$&&(D=w$toggle(w.$w.$[A],D))),(w.$w||(w.$w={})).$[A]=D;null!=(f=w$attribute(b,"w:on:"+c+":action"))&&(w=b,q=h(b,f,{}),0<(z=k(f))&&(w=w$find(w,f.substring(0,z))),w$action(w,a,q));if(null!=(f=w$attribute(b,"w:on:"+c))){if(!f){r=!0;break a}else if("default"==f){r=!1;break a}-1!=(z=
k(f))&&(d=h(b,f.substring(z),d||{}),f=f.substring(0,z));r=w$on(a,f,b,d,f,!0);if(null!==r)break a}null!=(f=w$attribute(b,"w:on:"+c+":href"))&&(w=b,q=h(b,f,{}),0<=(z=k(f))&&(f=f.substring(0,z)),window.open(w$setParameters(q,f),(m=w.getAttribute("target"))?m:"_self"))}var t=b.classList;if(t)for(A=0;A<t.length;++A){var p=t[A];if(p&&(m=WEAVEWORLD.w$type[p])&&"function"==typeof m[c]){f=m;v=w$data(b);var n;v&&!w$isArray(v)&&(f=WEAVEWORLD.w$setPrototypeOf(v,m));if(n=m[c+"$arg"])d=w$arg(b,n,d);var E=w$checkArg(b,
c,d);E?(w$warning(b),w$warning(b,E),r=void 0):r=m[c].call(f,b,a,d);if(null!==r)break a}}}null===r&&(m=WEAVEWORLD.w$type[""])&&"function"==typeof m[c]&&(f=m,(v=w$find$(b))&&(v=v.$w)&&(v=v.$)&&!w$isArray(v)&&(f=WEAVEWORLD.w$setPrototypeOf(v,m)),r=m[c].call(f,document.body,a,d));if(null!==r)return a&&(!1===r||"dragover"==a.type?(a.stopPropagation(),a.cancelBubble=!0):"dragstart"!=a.type&&w$no(a)),r;if(!c.startsWith("on")&&!g){console.log("Can not find event handler for "+c,l);return}}catch(u){console.log("Event handling error during `"+
c+"`",u)}return null}LOG=0;
function WElement(a,c,b,d){this.nodeName=a.nodeName;if(3==a.nodeType){var e=a.textContent,g=w$says(e);this.textContent=g;e!=g&&(a.textContent=g)}else if(1==a.nodeType){a.normalize();var k;if((k=a.attributes)&&k.length){this.attributes=[];for(var h=0;h<k.length;++h){var l=k[h];e=l.value;g=w$says(e);c&&"w:define"==l.name&&(c[g]=this);this.attributes.push({name:l.name,value:w$says(g)});e!=g&&a.setAttribute(l.name,g)}}if(a=a.firstChild)for(this.childNodes=[];e=a;)a=e.nextSibling,1==e.nodeType||3==e.nodeType?
(this.childNodes.push(new WElement(e,c,b,d)),"w:else"==e.nodeName&&w$removeElement(e)):8==e.nodeType&&d&&d(w$says(e.textContent))}}Object.defineProperty(WElement.prototype,"nodeType",{get:function(){return"#text"==this.nodeName?3:1}});WElement.prototype.getAttribute=function(a){var c;if(c=this.attributes)for(var b=0;b<c.length;++b)if(c[b].name==a)return c[b].value;return null};WElement.prototype.hasAttribute=function(a){return null!=this.getAttribute(a)};
WElement.prototype.cloneNode=function(a){if(3==this.nodeType)var c=document.createTextNode(this.textContent);else if(1==this.nodeType){c=document.createElement(this.nodeName);var b;if(b=this.attributes)try{for(var d=0;d<b.length;++d){var e=b[d];c.setAttribute(e.name,e.value)}}catch(g){console.log(g,this)}if(a&&(b=this.childNodes))try{for(d=0;d<b.length;++d)c.appendChild(b[d].cloneNode(!0))}catch(g){console.log(g,this)}}return c};function WAttributeReference(a,c){this.parentElement=a;this.name=c}
Object.defineProperty(WAttributeReference.prototype,"value",{get:function(){return this.parentElement.getAttribute(this.name)}});Object.defineProperty(WAttributeReference.prototype,"nodeType",{get:function(){return 2}});
WEAVEWORLD=function(){function a(a){return a&&("undefined"==typeof a.length||0<a.length)}function c(a,b,f){var c;if(0==f.length)return b;if("undefined"!=f){if("null"==f)return null;if("true"==f)return!0;if("false"==f)return!1;if('""'==f||"''"==f)return"";if("0"==f)return 0;if("1"==f)return 1;if(f.match("(^([a-zA-Z_$][a-zA-Z0-9_$]*){0,1}\\\\)|(^[@a-zA-Z_$][a-zA-Z0-9_$]*)")){if(-1!=(c=f.indexOf("\\")))if(0==c)b=document.body.$w.$;else{var d=f.substring(0,c);a:for(;null!=(a=a.parentElement);){if(a==
document.body){b=a.$w.$;break}if(a.$w&&("."==d||a.classList.contains(d))){b=a.$w.$;if(-1!=(d=f.indexOf("\\",c+1))){d=f.substring(c+1,d);f=f.substring(c+1);continue a}break}}}f=f.substring(c+1);if(-1==f.indexOf("."))return null!=b?b[f]:void 0;a=f.split(".");b=null!=b?b[a[0]]:void 0;for(f=1;f<a.length;++f)c=a[f],b=null!=b&&c in b?b[c]:void 0;return b}return eval(f)}}function b(b,d,f){for(var e=0,m,h=0;h<=f.length;++h){var g=f.charAt(h);if("|"==g||""==g){var r=g=m=void 0,k=b,l=d;e=f.substring(e,h);var t=
0;if("!"==e.charAt(0))m=!a(c(k,l,e.substring(1)));else{for(var p=0;p<=e.length;++p){var n=e.charAt(p);if("="==n||"!"==n||""==n)r?(t=c(k,l,e.substring(t,p)),t="undefined"!=typeof t?g==t:"undefined"==typeof g,"="==r?m="undefined"==typeof m?t:m||t:"!"==r&&(m="undefined"==typeof m?!t:m&&!t)):g=c(k,l,e.substring(t,p)),t=p+1,r=n}m="undefined"!=typeof m?m:g}if(a(m))break;e=h+1}}return m}function d(c,e,f){for(var m=0,h,g,r=0;r<=f.length;++r){var k=f.charAt(r);if("?"==k||":"==k||""==k){if(!h)g=b(c,e,f.substring(m,
r));else if("?"==h){if(a(g))return b(c,e,f.substring(m,r));if(""!=k)return d(c,e,f.substring(r+1))}else if(":"==h){if(!a(g))return b(c,e,f.substring(m,r));if(""!=k)return d(c,e,f.substring(r+1))}m=r+1;h=k}}return g}function e(a,b,f){var c;if(!f)return b;try{if(f.startsWith("[")&&-1!=(c=f.indexOf("]"))){var m=e(a,b,f.substring(c+1));-1==(c=(f=f.substring(1,c)).indexOf(" "))&&(c=f.length);var g=f.substring(0,c),k,r,l=a;for(;l;l=l.parentElement){var D=l.classList;if(D)for(var t=0;t<D.length;++t){var p=
D[t];if(p&&(k=r=h.w$type[p])&&"function"==typeof r[g])return b&&"object"==typeof b&&!Array.isArray(b)&&(k=h.w$setPrototypeOf(b,r)),m=r[g].call(k,a,m,f.substring(c+1)),m=w$proxy(m)}}if("function"==typeof(k=h.to)[g])return b&&"object"==typeof b&&!Array.isArray(b)&&(k=b),m=h.to[g].call(k,a,m,f.substring(c+1)),w$proxy(m);if("function"==typeof(k=this)[g])return b&&"object"==typeof b&&!Array.isArray(b)&&(k=b),m=this[g].call(k,m,f.substring(c+1)),w$proxy(m);console.log("Transformation `"+g+"` was not found at:",
a)}return d(a,b,f)}catch(n){throw console.log("Exception evaluating `"+f+"`:",n,a),n;}}function g(a,b,f,c){for(var d=0,m,h,q=null;-1!=(m=f.indexOf("{{",d))&&-1!=(h=f.indexOf("}}",m));)d<m&&(q=(q||"")+f.substring(d,m)),d=e(a,b,f.substring(m+2,h)),c&&(d=null!=d?JSON.stringify(d):"null"),null!=d&&(q=null!=q?String(q)+d:d),d=h+2;0==d?q=e(a,b,f):d<f.length&&(q=null!=q?String(q)+f.substring(d):f.substring(d));!1!==c&&null!=q&&"string"!=typeof q&&(q=String(q));return q}function k(a,b,f,c){if(!b||!b.length)return!1;
var d=!1,e=a.getAttribute("w:reflect"),q;e=e&&(q=Object.getPrototypeOf(f))?q[e]:null;try{q=[];for(var k=0;k<b.length;++k)q.push(b[k]);for(k=0;k<q.length;++k){var m=q[k].name,l=q[k].value;b=m;var r,p=!1;h.weave$currentAttr=m;if(2!==c)if(m.startsWith(r="w:attr:")){p=!0;m=m.substring(r.length);var n=g(a,f,l);e&&!1===e.call(f,a,b,n)||n!=a.getAttribute(m)&&(null!=n?a.setAttribute(m,n):a.removeAttribute(m))}else if(m.startsWith(r="w:data:"))p=!0,m="data-"+m.substring(r.length),n=g(a,f,l),e&&!1===e.call(f,
a,b,n)||n!=a.getAttribute(m)&&(null!=n?a.setAttribute(m,n):a.removeAttribute(m));else if(m.startsWith(r="w:style:"))p=!0,m=m.substring(r.length),n=g(a,f,l,!1),e&&!1===e.call(f,a,b,n)||n!=a.style[m]&&(a.style[m]=n);else if(m.startsWith(r="w:class:")){if(p=!0,m=m.substring(r.length),n=w$cond(g(a,f,l,!1)),!e||!1!==e.call(f,a,b,n)){var E=a.classList;n?E.has(m)||E.add(m):E.has(m)&&E.remove(m)}}else if("w:text"==m)p=d=!0,n=g(a,f,l),e&&!1===e.call(f,a,b,n)||a.textContent==n||(a.textContent=n||"");else if("w:html"==
m)p=d=!0,n=g(a,f,l),e&&!1===e.call(f,a,b,n)||(a.innerHTML=n||"");else if("w:show"==m)p=!0,n=g(a,f,l,!1),e&&!1===e.call(f,a,b,n)||w$show(a,"undefined"!=typeof n?n:null);else if("w:enable"==m)p=!0,n=w$toggle(g(a,f,l,!1)),e&&!1===e.call(f,a,b,n)||(n?a.hasAttribute("disabled")||a.setAttribute("disabled",""):a.hasAttribute("disabled")&&a.removeAttribute("disabled"));else if("w:for"==m)p=!0,n=g(a,f,l,!1),(a.$w||(a.$w={})).$for=n;else if("w:checked"==m&&(p=!0,n=l,!e||!1!==e.call(f,a,b,n))&&(n=w$findName(a))){n=
g(a,f,n,!1);var u="OPTION"==a.nodeName?"selected":"checked";(l||"")==(n||"")?a.setAttribute(u,""):a.removeAttribute(u);break}p||1===c||("w:set"==m?(m=m.substring(r.length),n=g(a,f,l,!1),e&&!1===e.call(f,a,b,n)||("INPUT"==a.nodeName?n!=a.getAttribute("value")&&(null!=n?a.setAttribute("value",n):a.removeAttribute("value")):"SELECT"==a.nodeName?a.value=n:a.innerText=n,h.weave$currentAttr=!1,w$check(a,n||null))):m.startsWith(r="w:set:")?(m=m.substring(r.length),n=g(a,f,l,!1),e&&!1===e.call(f,a,b,n)||
(a[m]=n)):"w:warning"==m?(n=g(a,f,l),e&&!1===e.call(f,a,b,n)||(a.setCustomValidity&&a.setCustomValidity(n||""),n?a.setAttribute("w:validity",n):a.removeAttribute("w:validity"))):"w:show:for"==m?(n=g(a,f,l,!1),e&&!1===e.call(f,a,b,n)||w$show(a,w$for(a,n))):"w:enable:for"==m&&(n=g(a,f,l,!1),e&&!1===e.call(f,a,b,n)||(a.disabled=!w$for(a,n))))}}finally{h.weave$currentAttr=null}return d}var h={w$type:{"":{}},w$ajax$error:null,w$defined:{},"@time":0,"@end":0,menuStack:[],w$proxy$sets:new Set,w$proxy$paused:new Set,
w$proxy$when:0,w$proxy$AnimationFrame:null,w$process:function(a,b,f){var c=h.w$weaver[a[0]];if(!c)throw["Not found",a,{el:b,div:f}];c(a[2],b,a[3],f)},weave$current:null,W$REFRESH:!0,W$TOGGLE:"+-",W$SAY_BEGIN:"§",W$SAY_END:"§",W$SAY_CODE:"|"},l=h.w$events={holdTime:2E3,clickedTime:2E3,clickCount:0,buttons:0,mouseDownTime:0,keyDownTime:0,mouseAnchor:{x:0,y:0},mouseEvent:{},keyEvent:{},timeoutID:0,timeoutClickedID:0,target:null,setTimeOut:function(a,b){clearTimeout(l.timeoutID);a&&(l.timeoutID=setTimeout(a,
b||l.holdTime))},setTimeOutClicked:function(a,b){clearTimeout(l.timeoutClickedID);a&&(l.timeoutClickedID=setTimeout(a,b||l.clickedTime))}};document.addEventListener("keydown",function(a){l.setTimeOutClicked();l.keyDownTime=a.timeStamp;l.keyEvent=a;l.setTimeOut(function(){w$on(a,"keyhold")});w$on(a,"keydown")},!1);document.addEventListener("keyup",function(a){l.setTimeOut();w$on(a,"keyup")},!1);document.addEventListener("keypress",function(a){w$on(a,"keypress")},!1);document.addEventListener("click",
function(a){w$on(a,"click")},!1);document.addEventListener("dblclick",function(a){w$on(a,"dblclick")},!1);document.addEventListener("wheel",function(a){w$on(a,"wheel")},!1);document.addEventListener("touchstart",function(a){w$on(a,"touchstart")},!1);document.addEventListener("touchmove",function(a){w$on(a,"touchmove")},!1);document.addEventListener("mouseout",function(a){l.setTimeOut();w$on(a,"mouseout")},!1);document.addEventListener("mouseover",function(a){l.setTimeOut();w$on(a,"mouseover")},!1);
document.addEventListener("mousedown",function(a){if(500<=a.timeStamp-l.mouseDownTime||8<Math.abs(l.mouseAnchor.x-a.clientX)||8<Math.abs(l.mouseAnchor.y-a.clientY))l.clickCount=0;l.clickCount++;l.buttons=a.buttons;l.mouseDownTime=a.timeStamp;l.mouseAnchor.x=a.clientX;l.mouseAnchor.y=a.clientY;l.mouseEvent=a;w$on(a,"mousedown");l.setTimeOut(function(){w$on(a,"mousehold")});l.setTimeOutClicked();return!0},!0);document.addEventListener("mousemove",function(a){l.mouseEvent=a;"undefined"!=typeof W$MOUSEMOVE&&
W$MOUSEMOVE&&w$on(a,"mousemove");l.setTimeOut(function(){w$on(a,"mousehold")})},!1);document.addEventListener("mouseup",function(a){l.mouseEvent=a;if(w$on(a,"mouseup"))return!0;if(500>=a.timeStamp-l.mouseDownTime&&8>=Math.abs(l.mouseAnchor.x-a.clientX)&&8>=Math.abs(l.mouseAnchor.y-a.clientY)){if(w$on(a,"mouseclick"))return!0;l.setTimeOut();l.setTimeOutClicked(function(){w$on(a,"mouseclicked")},333)}else l.setTimeOut();return!0},!0);document.addEventListener("input",function(a){w$on(a,"input")},!1);
document.addEventListener("change",function(a){w$on(a,"change")},!1);document.addEventListener("dragstart",function(a){w$on(a,"dragstart")},!1);document.addEventListener("dragenter",function(a){w$on(a,"dragenter")},!1);document.addEventListener("dragover",function(a){w$on(a,"dragover")},!1);document.addEventListener("dragleave",function(a){w$on(a,"dragleave")},!1);document.addEventListener("drop",function(a){w$on(a,"drop")},!1);document.addEventListener("paste",function(a){w$on(a,"paste")},!1);document.addEventListener("contextmenu",
function(a){w$on(a,"contextmenu")},!1);h.W$HTMLTAGS="P BR B I U IMG A".split(" ");h.w$normalizeHTML=function f(a){try{for(var b=a.childNodes.length;0<=--b;){var c=a.childNodes[b];if(1==c.nodeType)if(f(c),"BR"==c.nodeName&&"DIV"==a.nodeName&&b==a.childNodes.length-1)w$removeElement(c);else if(!h.W$HTMLTAGS.includes(c.nodeName)){for("DIV"==c.nodeName&&a.insertBefore(document.createElement("BR"),c);c.childNodes.length;){var d=c.childNodes[0];1!=d.nodeType&&3!=d.nodeType||a.insertBefore(d,c)}w$removeElement(c)}}a.normalize()}catch(C){console.log(C)}return a};
h.w$weaver={eval:function(a,f,b,c){eval(a)},html:function(a,f,b,c){var d=Array.isArray(f)?f[0]:f;switch(a){case "begin":h["@end"]=0;break;case "end":h["@end"]=1;break;case "open":b&&b.url?location=b.url:location.reload();break;case "text":for(a=0;a<f.length;++a)d=f[a],d.textContent=b.$;break;case "html":for(a=0;a<f.length;++a)d=f[a],d.innerHTML=b.$;break;case "attr":for(a=0;a<f.length;++a){d=f[a];for(var e in b)d.setAttribute(e,b[e])}break;case "prop":for(a=0;a<f.length;++a)for(e in d=f[a],b)d[e]=
b[e];break;case "style":for(a=0;a<f.length;++a)for(e in d=f[a],b)c=b[e],null!=c?d.style[e]=c:d.style.removeProperty(e);break;case "validity":LOG&&console.log("validity",f);for(a=0;a<f.length;++a)d=f[a],d.setCustomValidity(b.message);break;case "remove":for(a=0;a<f.length;++a)d=f[a],w$removeElement(d);break;case "content":for(f=c?c.childNodes:[];0<d.childNodes.length;)w$removeElement(d.firstChild);for(;0<f.length;)d.appendChild(f[0]);break;case "addBegin":f=c?c.children:[];for(b=d.firstElementChild;0<
f.length;)d.insertBefore(e=f[0],b),b=e;break;case "addEnd":for(f=c?c.children:[];0<f.length;)d.appendChild(f[0]);break;case "addBefore":f=c?c.children:[];b=d;for(d=d.parentElement;0<f.length;)d.insertBefore(e=f[0],b),b=e;break;case "addAfter":f=c?c.children:[];b=d.nextSibling;for(d=d.parentElement;0<f.length;)d.insertBefore(e=f[0],b),b=e;break;case "replace":f=c?c.children:[];b=d;for(d=d.parentElement;0<f.length;)d.insertBefore(e=f[0],b),b=e;d.removeChild(b)}},open:function(a,f,b,c){location.reload()}};
h.w$receive=function(a,f){if(a)if("string"==typeof a)for(var b=a.indexOf("\x3c!--[");-1!=b;){var c=b+4,d=a.indexOf("]--\x3e",c),e=a.substring(c,d+1);b=a.indexOf("\x3c!--[",d+4);if("[]"!=e)try{var g=JSON.parse(e),k=g[1]?w$queryAll(g[1]):document.body,l;e=null;var t;(l=g[4])&&h["@time"]<(l=Number(l))&&(h["@time"]=l);if("\x3c!--[]--\x3e"==a.substring(b,b+9)&&(t=a.substring(d+4,b).trim())){e=document.createElement("DIV");if(t.startsWith("<td")||t.startsWith("<tr")){var p=document.createElement("TABLE");
e.appendChild(p);e=p}t.startsWith("<td")&&(t="<tr>"+t+"</tr>");e.innerHTML=t;if(t.startsWith("<td")||t.startsWith("<tr"))e=e.tBodies[0];t.startsWith("<td")&&(e=e.rows[0])}h.w$process(g,k,e)}catch(n){console.log("EXCEPTION:",a.substring(c-4,-1!=b?b:a.length),n)}}else f.w$element&&w$weave(f.w$element,f.w$cmd,a,f.weave$data),f.callback&&f.callback(a,f)};h.to={"?":function(a,f,b){"true"==b?b=!0:"1"==b?b=1:""===b?b=!0:b.startsWith("'")&&"'"==b.charAt(b.length-1)&&(b=b.substring(1,b.length-2));return w$is(f,
b)},"??":function(a,b,c){c.startsWith("'")&&"'"==c.charAt(c.length-1)&&(c=c.substring(1,c.length-2));return w$is(b,c)},"?1":function(a,b,c){return w$is(b,1)},"!":function(a,b,c){"true"==c?c=!0:"1"==c?c=1:""===c?c=!0:c.startsWith("'")&&"'"==c.charAt(c.length-1)&&(c=c.substring(1,c.length-2));return w$toggle(b,c)},"!!":function(a,b,c){c.startsWith("'")&&"'"==c.charAt(c.length-1)&&(c=c.substring(1,c.length-2));return w$toggle(b,c)},"!1":function(a,b,c){return w$toggle(b,1)},"()":function(a,b,c){return c&&
c.trim()?w$arg(a,c):{}},"?=":function(a,b,c){return b?encodeURIComponent(b):""},"?()":function(a,b,c){return w$setParameters(c&&c.trim()?w$arg(a,c):{},"?")},"??()":function(a,b,c){b=window.location.href;var f,d="?";-1!=(f=b.indexOf("?"))&&(d=b.substring(f));return w$setParameters(c&&c.trim()?w$arg(a,c):{},d)}};h.weave$evalMacro=g;h.w$apply=function w(b,c,d,g,l){var f=c=w$proxy(c),q=h.weave$current;h.weave$currentAttr=null;try{if(2==b.nodeType)return k(h.weave$current=b.parentElement,[b],c,0),b;h.weave$current=
b;if(null==d)if(b.$w&&b.$w.w$)d=b.$w.w$,g||(g=!0);else{if(g)throw["Not woven Element",b];d=b;b=d.cloneNode(!1);(b.$w||(b.$w={})).w$=d;d.parentElement.replaceChild(b,d)}else(b.$w||(b.$w={})).w$=d;if(l){var t=d.childNodes;g=d=null;var p;var n=-1;var z=l;do for(var u=d||0;u<(null!=g?g:t?t.length:0);++u){var v=t[u],C=!1;f=c;if(1==v.nodeType)if("W:ELSE"==v.nodeName)break;else if(v.hasAttribute("w:item")&&!v.getAttribute("w:item")){if(null==d){d=p=u;g=u+1;z=null;for(var F=u+1;F<t.length;++F){var B=t[F];
1==B.nodeType&&B.hasAttribute("w:item")&&!B.getAttribute("w:item")&&(p=F,g==u+1&&(g=F))}}++n>=l.$$.length-1&&(d=g=null,u=p);if(n<l.$$.length)f=l.$$[n],C=!0;else continue}var H,y=C&&l.w$map.get(f);(H=!!y)?v=y.$w.w$:y=v.cloneNode(!1);b.appendChild(y);C&&((y.$w||(y.$w={})).$$index=n,l.w$map.set(f,y));B=w(y,f,v,H,z)}while(null!=d&&d<(null!=g?g:t.length))}else if(1==b.nodeType){l=function(a,b){var c;if(c=a.getAttribute("w:use")){var d=h.w$defined[c];if(!d)throw"w:define `"+c+"` was not found";for(c=0;c<
d.attributes.length;++c){var g=d.attributes[c];"w:define"!=g.name&&(a.hasAttribute(g.name)||a.setAttribute(g.name,g.value))}b=d.childNodes}else(c=a.getAttribute("w:children"))&&e(a,f,c)&&(a.$w.w$=new WElement(a,h.w$defined,w$say),b=a.$w.w$.childNodes);return b};if((null!=(n=b.getAttribute("w:at"))||null!=(n=b.getAttribute("w:named"))||null!=(n=b.getAttribute("w:name")))&&n)for(n.startsWith("!")&&(n=n.substring(1)),p="$at$"+n,y=b;y;y=y.parentElement){var x=y.classList;if(x&&x.length)for(u=0;u<x.length;++u){var J;
if((J=h.w$type[x[u]])&&p in J){var K=(y.$w||(y.$w={})).$actions||(y.$w.$actions=[]);a:{for(B=0;B<K.length;++B)if(K[B].el==b)break a;K.push({el:b,$do:J[p]})}}}}var G=b.getAttribute("w:each");z=b.getAttribute("w:item");var I=b.getAttribute("w:if");p=!0;B=!1;t=d.childNodes;if(null!=G){x=f;null!=I&&(p=a(e(b,c,I)));if(p){if(x=-1===g?b.$w.$$:e(b,x,G),w$isArray(x)&&null!=(n=b.getAttribute("w:when"))){G=[];for(u=0;u<x.length;++u)a(e(b,x[u],n))&&G.push(x[u]);x=w$proxy(G)}}else x=null;w$isArray(x)||(x=w$proxy([]));
""!==z&&(n=b.getAttribute("w:type"))&&(x=h.w$setPrototypeOf(x,w$type[n]),b.classList.contains(n)||b.classList.add(n));b.$w.$$=x;g&&b.$w.w$map||(b.$w.w$map=new Map);for(;b.firstChild;)w$removeElement(b.firstChild);if(!(B=p=!!x.length))for(B=p=!0,u=0;u<t.length;++u)if("W:ELSE"==t[u].nodeName){B=p=!1;break}if(p)if(""===z)for(u=0;u<x.length;++u)y=g&&b.$w.w$map&&b.$w.w$map.get(x[u]),(H=!!y)||(y=b.cloneNode(!1),y.removeAttribute("w:each"),b.$w.w$map.set(x[u],y)),b.appendChild(y),w(y,x[u],d,H);else t=l(b,
t),k(b,b.attributes,c,1),w(b,c,d,g,b.$w)}else{if(null!=z){f=-1===g?b.$w.$:e(b,f,z);if(n=b.getAttribute("w:type"))f=h.w$setPrototypeOf(f,h.w$type[n]),b.classList.contains(n)||b.classList.add(n);b.$w.$=f;"object"!=typeof f||f.$original||(f.$w$direct$$original=w$assign({},f))}null!=(n=w$attribute(b,"w:named"))?B|=h.w$named(b,f,n):null!=(n=w$attribute(b,"w:name"))&&(B|=h.w$name(b,f,n,!0));t=l(b,t);B|=k(b,b.attributes,f,1);null!=I&&(p=a(e(b,c,I)),g=!1,b.$w.$if=p)}if(!B&&t){if(!p){for(u=0;u<t.length;++u)if(v=
t[u],"W:ELSE"==v.nodeName){p=v;t=v.childNodes;break}for(p||(t=null);b.lastChild;)w$removeElement(b.lastChild)}if(t){C=b.childNodes;if(g&&(g=t.length==C.length))for(u=0;u<C.length;++u)if(!(F=C[u]).$w||F.$w.w$!=t[u]){g=!1;break}if(g)for(t=C,u=0;u<t.length;++u)v=t[u],w(v,f,v.$w.w$,!0);else{for(;b.lastChild;)w$removeElement(b.lastChild);for(u=0;u<t.length;++u){v=t[u];if("W:ELSE"==v.nodeName)break;y=b.appendChild(v.cloneNode(!1));w(y,f,v)}}}}b.attributes&&k(b,b.attributes,f,2);b.$w.$actions&&(h.weave$currentAttr=
!1,w$action(b,null),LOG&&console.log(b.$w.$actions))}1==b.nodeType&&b.classList.remove("w")}finally{h.weave$current=q,h.weave$currentAttr=null}return b};h.w$setPrototypeOf=function(a,b){if(!b||!a||"object"!=typeof a||Array.isArray(a)||Object.getPrototypeOf(a)===b||b.isPrototypeOf(a))return a;if("undefined"==typeof Proxy){if(Object.getPrototypeOf(a)==Object.prototype)return Object.setPrototypeOf(a,b)}else Object.setPrototypeOf(a=w$proxy(a),b);return a};h.css=function(a){h.w$STYLE||(h.w$STYLE=w$element("style",
{name:"w:css"}),h.w$STYLE.appendChild(document.createTextNode("")),document.head.appendChild(h.w$STYLE));if("string"==typeof a){var b=h.w$STYLE.sheet;b.insertRule(a,b.length?b.length:0)}return h.w$STYLE};h.jsonTransfer=function(a,b){if("undefined"==typeof b){var c=a.dataTransfer&&a.dataTransfer.getData("application/json")||W$DATATransfer;return"string"==typeof(c=W$DATATransfer)&&c?JSON.parse(c):c}a.dataTransfer.setData("application/json",W$DATATransfer=b);return a.dataTransfer};h.w$for=function(a){if("string"==
typeof a&&a)switch(a.charAt().toLowerCase()){case "0":case "-":return 0;case "r":case "g":return 2;case "a":return 6;case "u":return 7;case "s":case "w":case "+":return 8;case "d":case "*":return 9}return 5};h.w$nameArgIndex=function(a){if(!a)return-1;var b=a.indexOf("{");a=a.indexOf("(");return-1!=b&&-1!=a?Math.min(b,a):-1!=b?b:-1!=a?a:-1};h.w$name=function(a,b,c,d){var e=a.nodeName,f,g,k=!1,l=c;var p=h.w$nameArgIndex(c);-1!=p&&(l=l.substring(p));b||(b={});l&&!a.hasAttribute("name")&&a.setAttribute("name",
l);l.startsWith("!")&&(l=l.substring(1));"undefined"!=typeof(g=f=b[l+"$type"])&&("boolean"==g?g="checkbox":"string"==g?g="text":"html"==g?g="text":"integer"==g&&(g="number"));(b[p=l+"$hint"]||b[p=l+"$title"])&&a.setAttribute("w:attr:title",c);if("FORM"==e)a.hasAttribute("accept-charset")||a.hasAttribute("w:attr:accept-charset")||a.setAttribute("accept-charset","utf-8"),a.hasAttribute("onsubmit")||(a.setAttribute("onsubmit","return w$submit(event)"),a.hasAttribute("w:on:onsubmit")||a.setAttribute("w:on:onsubmit",
c));else if("BUTTON"==e)(p=b[l+"$definition"])&&w$defineElement(a,p),a.hasAttribute("onclick")||a.hasAttribute("w:on:onclick")||a.setAttribute("w:on:onsubmit",c),(p=l+"$apt")in b&&!a.hasAttribute("disabled")&&!a.hasAttribute("w:attr:disabled")&&!a.hasAttribute("w:enable:for")?a.setAttribute("w:enable",p):(p=l+"$apt")in b&&!a.hasAttribute("disabled")&&!a.hasAttribute("w:attr:disabled")&&!a.hasAttribute("w:enable:for")&&a.setAttribute("w:enable:for",p);else if("SELECT"==e){if(p=b[l+"$definition"])k=
!0,w$defineSelect(a,p);(p=l+"$required")in b&&!a.hasAttribute("required")&&!a.hasAttribute("w:attr:required")&&a.setAttribute("w:attr:required","[??]"+p);a.hasAttribute("w:attr:value")||a.hasAttribute("w:set:value")||a.hasAttribute("w:set")||a.setAttribute("w:set",l);(p=l+"$for")in b&&!a.hasAttribute("disabled")&&!a.hasAttribute("w:enable:for")&&a.setAttribute("w:enable:for",p);d&&(l+"$check"in b||l+"$valid"in b)&&!a.hasAttribute("onchange")&&!a.hasAttribute("w:on:onchange")&&a.setAttribute("onchange",
"w$no(event); w$check(this); return false;");a.hasAttribute("w:warning")||a.setAttribute("w:warning",l+"$warning")}else if("INPUT"==e){c=b[l+"$length"];if("string"==typeof c&&c&&-1!=(g=c.indexOf(","))){var n=c.substring(g+1);c=c.substring(0,g)}"undefined"==typeof g||a.hasAttribute("type")||a.setAttribute("type",g);"string"==f&&(a.hasAttribute(p="autocorrect")||a.hasAttribute("w:attr:autocorrect")||a.setAttribute(p,"off"),a.hasAttribute(p="autocapitalize")||a.hasAttribute("w:attr:autocapitalize")||
a.setAttribute(p,"off"),a.hasAttribute(p="spellcheck")||a.hasAttribute("w:attr:spellcheck")||a.setAttribute(p,"false"));(p=b[p=l+"$definition"])&&w$defineElement(q,p);(p=l+"$required")in b&&!a.hasAttribute("required")&&!a.hasAttribute("w:attr:required")&&a.setAttribute("w:attr:required","[??]"+p);"undefined"==typeof b[p=l+"$placeholder"]||a.hasAttribute("placeholder")||a.hasAttribute("w:attr:placeholder")||a.setAttribute("w:attr:placeholder",p);if("button"==a.type||"submit"==a.type){var q;for(q=a;q&&
"FORM"!=q.nodeName;q=q.parentElement);LOG&&console.log("FORM",q,a);(p=l+"$apt")in b&&!a.hasAttribute("disabled")&&!a.hasAttribute("w:attr:disabled")&&!a.hasAttribute("w:enable:for")?a.setAttribute("w:enable",p):(p=l+"$apt")in b&&!a.hasAttribute("disabled")&&!a.hasAttribute("w:attr:disabled")&&!a.hasAttribute("w:enable:for")&&a.setAttribute("w:enable:for",p)}else"checkbox"==a.type||"radio"==a.type?(g=w$attribute(a,"value"),!l||a.hasAttribute("checked")||a.hasAttribute("w:attr:checked")||a.hasAttribute("w:set:checked")||
(null!=g?a.setAttribute("w:attr:checked",l+"='"+g+"'?'checked':null"):a.setAttribute("w:attr:checked",l+"?'checked':null"))):(a.hasAttribute("w:attr:value")||a.hasAttribute("w:set:value")||a.hasAttribute("w:set")||a.setAttribute("w:set",l),"number"==a.type||"date"==a.type?((p=l+"$min")in b&&!a.hasAttribute("min")&&!a.hasAttribute("w:attr:min")&&a.setAttribute("w:attr:min",p),a.hasAttribute("max")||a.hasAttribute("w:attr:max")||((p=l+"$max")in b?a.setAttribute("w:attr:max",p):c&&a.setAttribute("max",
Math.pow(10,c-n)-1)),"number"!=a.type||a.hasAttribute("step")||a.hasAttribute("w:attr:step")||(n?a.setAttribute("step",Math.pow(10,-n)):(p=l+"$step")in b?a.setAttribute("w:attr:step",p):"integer"!=f&&a.setAttribute("step","any"))):(a.hasAttribute("size")||a.hasAttribute("w:attr:size")||((p=l+"$size")in b?a.setAttribute("w:attr:size",p):c&&a.setAttribute("size",c)),!c||a.hasAttribute("maxlength")||a.hasAttribute("w:attr:maxlength")||a.setAttribute("maxlength",c),(p=l+"$pattern")in b&&!a.hasAttribute("pattern")&&
!a.hasAttribute("w:attr:pattern")&&a.setAttribute("w:attr:pattern",p)));d&&(l+"$check"in b||l+"$valid"in b)&&!a.hasAttribute("oninput")&&!a.hasAttribute("w:on:oninput")&&a.setAttribute("oninput","return w$name$oninput(this,event);");a.hasAttribute("w:warning")||a.setAttribute("w:warning",l+"$warning")}else"radio"!=a.getAttribute("type")&&("html"==f?(a.classList.contains("whtml")||a.classList.add("whtml"),a.hasAttribute("w:html")||a.hasAttribute("w:text")||a.setAttribute("w:html",p)):"text"==f&&(a.classList.contains("wtext")||
a.classList.add("wtext"),a.hasAttribute("w:html")||a.hasAttribute("w:text")||a.setAttribute("w:text",p)));return k};h.w$named=function(a,b,c){var d=a.nodeName,e=c.indexOf("{"),f=c.indexOf("("),g=c;-1!=e&&-1!=f?g=c.substring(0,Math.min(e,f)):-1!=e?g=c.substring(0,e):-1!=f&&(g=c.substring(0,f));b=h.w$name(a,b,g);"INPUT"==d?"button"!=a.type&&"submit"!=a.type&&"reset"!=a.type&&(a.hasAttribute("w:on:oninput:action")||a.setAttribute("w:on:oninput:action","()"),a.hasAttribute("oninput")||a.hasAttribute("w:on:oninput")||
a.setAttribute("w:on:oninput","")):"SELECT"==d&&(a.hasAttribute("w:on:onchange:action")||a.setAttribute("w:on:onchange:action","()"),a.hasAttribute("onchange")||a.hasAttribute("w:on:onchange")||a.setAttribute("w:on:onchange",""));return b};return h}();function w$name$oninput(a,c){w$no(c);w$check(a);return!1}function w$for(a,c){if(a instanceof HTMLElement){var b=a,d;for(a=void 0;b&&(!(d=b.$w)||!(a=d.$for));b=b.parentElement);}b=WEAVEWORLD.w$for(a);d=WEAVEWORLD.w$for(c);return b>=d}
function w$form(a){var c={},b=function(a,c,d){var e,f;-1!=(e=c.indexOf("."))?("object"!=typeof(f=a[c.substring(0,e)])&&(a[c.substring(0,e)]=f={}),b(f,c.substring(e+1),d)):"undefined"!=typeof d?a[c]=d:"undefined"==typeof a[c]&&(a[c]=null)};if(a&&"FORM"==a.nodeName){for(var d=a.elements,e=a.getAttribute("w:submit"),g=0;g<d.length;g++){var k=d.item(g);"radio"!=k.type&&"checkbox"!=k.type||k.checked?null!=e&&"submit"==k.type&&k.name&&k.name!=e||k.name&&b(c,k.name,k.value):k.name&&b(c,k.name,void 0)}w$queryAll("div[contenteditable='true']",
a,function(a){var d;if(d=a.getAttribute("name"))a=WEAVEWORLD.w$normalizeHTML(a).innerHTML,b(c,d,a)})}return c}function w$submit(a){var c=a.target,b=w$form(c);if(null===w$on(a,"submit",c,b))throw new ReferenceError("Event handler for w:on:onsubmit was not found");return w$no(a)}function w$find$(a){for(;a&&!(a.$w&&"$"in a.$w);a=a.parentElement);return a}function w$find$$(a){for(;a&&(!a.$w||!a.$w.$$);a=a.parentElement);return a}
function w$find$$index(a){a=w$find$(a);var c=a.$w.$,b;if(!(b=w$find$$(a)))return null;var d=b.$w.$$;return{$$:d,$:c,el:a,e:b,index:d.indexOf(c)}}function w$findName(a){for(;a;a=a.$w&&a.$w.parent||a.parentElement){var c;if(null!=(c=w$attribute(a,"w:name"))||null!=(c=w$attribute(a,"name")))return void 0==c.indexOf("{")!=-1&&(c=c.substring(0,void 0).trim()),c}return null}function w$data(a,c,b){if(c)return a=w$find(a,c,b),a.$w?a.$w.$:void 0;var d;return(d=w$find$(a))&&(d=d.$w)&&"$"in d?d.$:void 0}
function w$list(a,c,b){if(c)return a=w$find(a,c,b),a.$w?a.$w.$$:void 0;var d;return(d=w$find$$(a))&&(d=d.$w)&&"$$"in d?d.$$:void 0}function w$findRule(a,c){for(;a;a=a.parentElement){var b=a.classList;if(b)for(var d=0;d<b.length;++d){var e;if((e=WEAVEWORLD.w$type[b[d]])&&c in e)return e[c]}}}
function w$use(a,c,b,d){var e=WEAVEWORLD.w$defined[a];if(!e)throw new ReferenceError("w:define `"+a+"` was not found");a=e.cloneNode(!1);a.removeAttribute("w:define");b?b.insertBefore(a,d):d&&((a.$w||(a.$w={})).parent=d);WEAVEWORLD.w$apply(a,c,e);return a}function w$merge(a,c){a instanceof HTMLElement&&(a=w$data(a));if(c&&"object"==typeof c){var b,d;for(d in c)(b=c[d])&&"object"==typeof b&&!w$isArray(b)?w$merge(a[d],b):a[d]=b}return a}
function w$weave(a,c,b,d){var e;"undefined"==typeof c&&(c="");"undefined"!=typeof d&&(c.endsWith(":")&&("object"!=typeof b||0===Object.keys(b).length&&b.constructor===Object)||(b=d));a||(a=document.body);d=WEAVEWORLD.W$REFRESH;var g="object"==typeof b&&b&&!w$isArray(b);c.startsWith("~")?(c=c.substring(1),d=!1):(w$warning(a),c.startsWith("!")&&(c=c.substring(1),d=!0));switch(c){case "[":case "]":b&&(a=w$find$$(a))&&("["==c?a.$w.$$.unshift(b):a.$w.$$.push(b),g&&w$warning(a,b),d&&w$refresh("now",a));
break;case "<":case ">":!(e=w$find$$index(a))||">"!=c&&-1==e.index||(e.$$.splice("<"==c?e.index:e.index+1,0,b),g&&w$warning(e.e,b),d&&w$refresh("now",e.e));break;case "-":(e=w$find$$index(a))&&-1!=e.index&&(e.$$.splice(e.index,1),g&&w$warning(e.e,b),d&&w$refresh("now",e.e));break;case "#":if(a=w$find$$(a))w$isArray(b)||(b=w$proxy([])),Array.prototype.splice.apply(a.$w.$$,[0,a.$w.$$.length].concat(b)),g&&w$warning(a,b),d&&w$refresh("now",a);break;case ".":(e=w$find$$index(a))&&-1!=e.index&&(e.$$[e.index]=
b,e.el.$w.$=b,g&&w$warning(e.el,b),d&&w$refresh("now",e.el));break;case "=":if(a=w$find$(a))a.$w.$=b,g&&w$warning(a,b),w$refresh("now",a);break;case "?":(a=w$find$(a))&&g&&w$warning(a,b);break;default:if(a=w$find$(a))"object"==typeof b&&w$merge(a.$w.$,b),g&&w$warning(a,b),d&&w$refresh("now",a)}return a}
function w$refresh(a,c,b){cancelAnimationFrame(WEAVEWORLD.w$proxy$AnimationFrame);WEAVEWORLD.w$proxy$AnimationFrame=null;var d;if(d="now"==a)a=c,c=b;if("number"==typeof a){if(performance.now()<WEAVEWORLD.w$proxy$when){WEAVEWORLD.w$proxy$AnimationFrame=requestAnimationFrame(w$refresh);return}}else if(a){if(a instanceof HTMLElement){WEAVEWORLD.w$proxy$sets.add(a);var e;if(c&&a.$w&&(e=a.$w.$))for(var g in c)e[g]=c[g]}else a instanceof Set&&a.forEach(function(a,b,c){w$hasParent(a)&&WEAVEWORLD.w$proxy$sets.add(a)});
if(!d){WEAVEWORLD.w$proxy$when=performance.now()+10;WEAVEWORLD.w$proxy$AnimationFrame=requestAnimationFrame(w$refresh);return}}a=WEAVEWORLD.w$proxy$sets;if(a.size){var k=new Map;a.forEach(function(b,c,d){if(w$hasParent(b)){for(c=b.parentElement;c;c=c.parentElement)if(a.has(c)||WEAVEWORLD.w$proxy$paused.has(c))return;if(b instanceof WAttributeReference){(c=k.get(b.parentElement))||k.set(b.parentElement,c=[]);if(c.includes(b.name))return;c.push(b.name)}if(c=w$find$(b))LOG&&console.log("--------\x3e",
b,c.$w.$),WEAVEWORLD.w$apply(b,c.$w.$,null,-1)}});WEAVEWORLD.w$proxy$sets.clear()}}
function w$proxyHandler(a){this.$w$={};this.setPrototypeOf=function(a,b){if(!b||!a||"object"!=typeof a||Array.isArray(a)||Object.getPrototypeOf(a)===b||b.isPrototypeOf(a))return a;var c=this.$w$prototype||(this.$w$prototype=[]);c.includes(b)||c.push(b);return!0};this.getPropertyDescriptor=function(a,b){for(var c,e=a;e;e=Object.getPrototypeOf(e))if(c=Object.getOwnPropertyDescriptor(e,b))return c;if(this.$w$prototype)for(var g=0;g<this.$w$prototype.length;++g)for(e=this.$w$prototype[g];e;e=Object.getPrototypeOf(e))if(c=
Object.getOwnPropertyDescriptor(e,b))return c};this.has=function(a,b){if(b in a)return!0;if(this.$w$prototype)for(var c=0;c<this.$w$prototype.length;++c)try{if(b in this.$w$prototype[c])return!0}catch(e){console.log(e)}return!1};this.get=function(a,b){if("symbol"==typeof b)return a[b];if("$w$proxy"==b)return this.$w$proxy;if("$w$object"==b)return a;if("$w$"==b)return this.$w$;if("$w$isArray"==b)return Array.isArray(a);b.startsWith("$w$direct$")?b=b.substring(10):WEAVEWORLD.weave$current&&!1!==WEAVEWORLD.weave$currentAttr&&
(this.$w$[" "+b]||(this.$w$[" "+b]=new Set)).add(WEAVEWORLD.weave$currentAttr?new WAttributeReference(WEAVEWORLD.weave$current,WEAVEWORLD.weave$currentAttr):WEAVEWORLD.weave$current);var c=this.getPropertyDescriptor(a,b);var e=c?c.get?c.get.call(this.$w$proxy):c.value:a[b];return null===e||"object"!=typeof e||e.$w$proxy||!c.writable?e:a[b]=w$proxy(e)};this.set=function(a,b,d){var c;if(b.startsWith("$w$direct$"))b=b.substring(10);else{var g=a[b],k=w$isArray(a)?a.length:null;d!==g&&this.$w$&&(c=this.$w$[" "+
b])&&c.size&&(LOG&&console.log("SET:"+b+"=",d,g,c),delete this.$w$[" "+b],w$refresh(c))}for(var h,l=a;l&&!(h=Object.getOwnPropertyDescriptor(l,b));l=Object.getPrototypeOf(l));h&&h.set?d=h.set.call(this.$w$proxy,w$proxy(d)):a[b]=w$proxy(d);b="length";null!=k&&a.len!=k&&(c=this.$w$[" "+b])&&c.size&&(LOG&&console.log("SET:"+b+"=",d,g,c),delete this.$w$[" "+b],w$refresh(c));return!0};this.deleteProperty=function(a,b){return b in a?(delete a[b],b="length",w$isArray(a)&&(e$=this.$w$[" "+b])&&e$.size&&(LOG&&
console.log("SET:"+b+"=",e$),delete this.$w$[" "+b],w$refresh(e$)),!0):!1}}function w$proxy(a){if(null===a||"object"!=typeof a||a.$w$proxy||"undefined"==typeof Proxy)return a;var c=new w$proxyHandler(a);a=new Proxy(a,c);return c.$w$proxy=a}
function w$say(a,c){var b,d,e,g;if(g="undefined"==typeof c)c=a;if(-1!=(d=a.indexOf(b=WEAVEWORLD.W$SAY_CODE))){if(0==d)return a.substring(b.length);c=a.substring(d+b.length);a=a.substring(0,d)}"undefined"!=typeof W$DICTIONARY&&null!=(e=W$DICTIONARY[a])?c=e:g&&console.log("SAY:"+a+":");return c}
function w$says(a){var c,b,d,e;if(!a||-1==(c=a.indexOf(b=WEAVEWORLD.W$SAY_BEGIN)))return a;for(var g="";-1!=c&&-1!=(j=a.indexOf(d=WEAVEWORLD.W$SAY_END,c+b.length));){var k=a.substring(c+b.length,j),h,l,m=k;0<(h=k.indexOf(e=WEAVEWORLD.W$SAY_CODE))&&(m=k.substring(h+e.length),k=k.substring(0,h));0==h?m=k.substring(h+e.length):"undefined"!=typeof W$DICTIONARY&&null!=(l=W$DICTIONARY[k])?m=l:console.log("SAY:"+k+":");g+=a.substring(0,c)+m;c=(a=a.substring(j+d.length)).indexOf(b)}return g+a}
function w$define(a,c){var b;if(w$isArray(a))for(b=0;b<a.length;++b)w$define(a[b]);else{if("string"==typeof a&&"undefined"==typeof c)return WEAVEWORLD.w$type[a];"string"==typeof a&&(b=a,a=c);if("object"!=typeof a)throw Error("Invalid w$define arguments.",arguments);if("undefined"==typeof b&&(b=a.$name,"string"!=typeof b))throw Error("Invalid w$define arguments: no name.",arguments);var d=WEAVEWORLD.w$type[b];if("string"==typeof a.$type&&a.$type){if(d)throw Error("Invalid w$define redefinition: base $type defined, too.",
arguments);if(!(d=WEAVEWORLD.w$type[a.$type]))throw Error("w$define base $type was not found.",arguments);}else d||(d=WEAVEWORLD.w$type[""]);d&&Object.setPrototypeOf(a,d);WEAVEWORLD.w$type[b]=a}}
function w$replace(a,c){w$ajax({method:"GET",url:a,success:function(a,d){a="<div"+a.substring(a.indexOf("<body")+5);a=a.substring(0,a.lastIndexOf("</body"))+"</div>";for(var b=w$element("div",{"w:html":a}).firstElementChild;document.body.attributes.length;)document.body.removeAttribute(document.body.attributes[0].name);for(var g=0;g<b.attributes.length;++g)document.body.setAttribute(b.attributes[g].name,b.attributes[g].value);for(;document.body.lastChild;)w$removeElement(document.body.lastChild);
b=b.children;for(g=0;g<b.length;++g)document.body.appendChild(b[g]);var k="",h="";document.body.$w={w$:new WElement(document.body,WEAVEWORLD.w$defined,w$say,function(a){a.startsWith(s="!w:css!")?k+="\n"+a.substring(s.length):a.startsWith(s="!w:script!")&&(h+="\n"+a.substring(s.length))})};k&&document.head.appendChild(w$element("style",{name:"!w:css","w:text":k+"\n"}));h&&document.head.appendChild(w$element("script",{name:"!w:script","w:text":h+"\n"}));c()}})}
document.addEventListener("DOMContentLoaded",function(){function a(a){W$DATA=w$proxy(a);document.body.$w.w$=new WElement(document.body,WEAVEWORLD.w$defined,w$say,function(a){var d;a.startsWith(d="!w:css!")?c+="\n"+a.substring(d.length):a.startsWith(d="!w:script!")&&(b+="\n"+a.substring(d.length))});c&&document.head.appendChild(w$element("style",{name:"!w:css","w:text":c+"\n"}));b&&document.head.appendChild(w$element("script",{name:"!w:script","w:text":b+"\n"}));WEAVEWORLD.w$apply(document.body,W$DATA,
null,!0);if("object"==typeof W$ONLOAD&&Array.isArray(W$ONLOAD))for(a=0;a<W$ONLOAD.length;++a)W$ONLOAD[a].call(WEAVEWORLD);"function"==typeof W$SYNC&&W$SYNC()}WEAVEWORLD.w$defined={};var c="",b="";document.body.$w||(document.body.$w={});document.body.$w.$=WEAVEWORLD.W$DATA;"string"==typeof W$START?W$CALL(W$START,W$DATA,function(b){a(b)}):"undefined"!=typeof W$DATA?("function"==typeof W$START&&(W$DATA=W$START(W$DATA)),a(W$DATA)):"function"==typeof W$START?a(W$START(w$getParameters())):document.body.classList.remove("w")});
Object.defineProperty(window,"W$TYPE",{configurable:!0,get:function(){return WEAVEWORLD.w$type},set:function(a){w$define(a)}});Object.defineProperty(window,"W$DATA",{configurable:!0,get:function(){return WEAVEWORLD.W$DATA},set:function(a){var c=window.document.body;WEAVEWORLD.W$DATA=a;c&&(c.$w||(c.$w={}),c.$w.w$?(c.$w.$=w$proxy(a),WEAVEWORLD.w$apply(c,a,null,!0)):c.$w.$=a)}});W$SYNC=W$START=void 0;W$ONLOAD=[];